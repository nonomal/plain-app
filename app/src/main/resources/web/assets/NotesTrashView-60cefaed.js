import{b as Z,u as tt,_ as et,a as ot}from"./list-5e8cf700.js";import{_ as st}from"./FieldId-d1ec1c14.js";import{_ as at}from"./Multiselect-6b10a69c.js";import{_ as nt}from"./Breadcrumb-754c867d.js";import{d as lt,p as ut,r as p,u as ct,A as rt,n as it,B as dt,D as pt,G as _t,H as mt,I as ht,U as ft,o as l,c as i,b as t,e as b,w as _,f as a,v as vt,J as $,M as B,g as n,N as bt,F as w,y as M,k as L,Q as gt,az as kt,z as K,R as x,ak as yt,al as $t,C as wt,t as z,ax as Vt,aA as Ct,K as St,L as Nt,x as It,P as G,m as Tt,_ as At}from"./index-79f9263f.js";import{b as Dt,a as Qt}from"./search-52423e6c.js";import{n as Ut}from"./list-6498ebd9.js";import{u as qt}from"./tags-1ae8d7cb.js";import"./VModal.vuevuetypescriptsetuptruelang-3158168b.js";import"./baseIndexOf-70b929c6.js";import"./vee-validate.esm-496cb60b.js";const Bt=m=>(yt("data-v-a85a9f40"),m=m(),$t(),m),Mt={class:"v-toolbar"},Lt={class:"right-actions"},Kt=["onClick"],xt={class:"row mb-3"},zt={class:"col-md-3 col-form-label"},Gt={class:"col-md-9"},Ft=["onKeyup"],Rt={class:"row mb-3"},Et={class:"col-md-3 col-form-label"},Ot={class:"col-md-9"},Pt={class:"actions"},Ht=["onClick"],Jt={class:"table"},jt=Bt(()=>t("th",null,"ID",-1)),Wt=["onClick"],Xt=["onUpdate:modelValue"],Yt=["onClick"],Zt={class:"badge"},te={class:"nowrap"},ee={class:"nowrap"},oe={key:0},se={colspan:"6"},ae={class:"no-data-placeholder"},ne={name:"NotesTrash",inheritAttrs:!1,customOptions:{}},le=lt({...ne,setup(m){var U,q;const V=ut(),u=p([]),{t:C}=ct(),c=rt({text:"",tags:[]}),S="NOTE",N=it().query,h=p(parseInt(((U=N.page)==null?void 0:U.toString())??"1")),f=50,v=p(0),r=p(dt(((q=N.q)==null?void 0:q.toString())??"")),I=p(""),{tags:F}=qt(S,r,c,async e=>{e.push({name:"trash",op:"",value:"true"}),I.value=Dt(e),await wt(),E()}),{deleteItems:T}=Z(kt,()=>{k()},u),{selectAll:g,toggleSelect:A}=tt(u),{loading:R,load:E,refetch:k}=pt({handle:(e,s)=>{s?z(C(s),"error"):e&&(u.value=e.notes.map(y=>({...y,checked:!1})),v.value=e.noteCount)},document:Vt,variables:()=>({offset:(h.value-1)*f,limit:f,query:I.value}),appApi:!0});_t(h,e=>{K(V,`/notes/trash?page=${e}&q=${x(r.value)}`)});function D(){r.value=Qt(c),Q()}function Q(){K(V,`/notes/trash?q=${x(r.value)}`)}mt(()=>{ht.on("refetch_by_tag_type",e=>{e===S&&k()})});const{mutate:O,onDone:P}=ft({document:Ct,appApi:!0});function H(){const e=u.value.filter(s=>s.checked);if(e.length===0){z(C("select_first"),"error");return}O({ids:e.map(s=>s.id)})}function J(e){Tt.push(`/notes/${e.id}`)}return P(()=>{k()}),(e,s)=>{const y=nt,j=at,W=et,X=st,Y=ot;return l(),i(w,null,[t("div",Mt,[b(y,{current:()=>`${e.$t("page_title.trash")} (${v.value})`},null,8,["current"]),t("div",Lt,[t("button",{class:"btn btn-restore",type:"button",onClick:_(H,["prevent"])},a(e.$t("restore")),9,Kt),t("button",{class:"btn btn-delete",type:"button",onClick:s[0]||(s[0]=_((...o)=>n(T)&&n(T)(...o),["prevent"]))},a(e.$t("delete")),1),b(W,{modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=o=>r.value=o),search:Q},{filters:vt(()=>[t("div",xt,[t("label",zt,a(e.$t("keywords")),1),t("div",Gt,[$(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>c.text=o),class:"form-control",onKeyup:Nt(D,["enter"])},null,40,Ft),[[St,c.text]])])]),t("div",Rt,[t("label",Et,a(e.$t("tags")),1),t("div",Ot,[b(j,{modelValue:c.tags,"onUpdate:modelValue":s[2]||(s[2]=o=>c.tags=o),label:"name","track-by":"id",options:n(F)},null,8,["modelValue","options"])])]),t("div",Pt,[t("button",{type:"button",class:"btn",onClick:_(D,["stop"])},a(e.$t("search")),9,Ht)])]),_:1},8,["modelValue"])])]),t("table",Jt,[t("thead",null,[t("tr",null,[t("th",null,[$(t("input",{class:"form-check-input",type:"checkbox",onChange:s[4]||(s[4]=(...o)=>n(A)&&n(A)(...o)),"onUpdate:modelValue":s[5]||(s[5]=o=>bt(g)?g.value=o:null)},null,544),[[B,n(g)]])]),jt,t("th",null,a(e.$t("title")),1),t("th",null,a(e.$t("tags")),1),t("th",null,a(e.$t("updated_at")),1),t("th",null,a(e.$t("created_at")),1)])]),t("tbody",null,[(l(!0),i(w,null,M(u.value,o=>(l(),i("tr",{key:o.id,class:It({checked:o.checked}),onClick:_(d=>o.checked=!o.checked,["stop"])},[t("td",null,[$(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>o.checked=d},null,8,Xt),[[B,o.checked]])]),t("td",null,[b(X,{id:o.id,raw:o},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:_(d=>J(o),["stop"])},a(o.title||e.$t("no_content")),9,Yt)]),t("td",null,[(l(!0),i(w,null,M(o.tags,d=>(l(),i("span",Zt,a(d.name),1))),256))]),t("td",te,a(n(G)(o.updatedAt)),1),t("td",ee,a(n(G)(o.createdAt)),1)],10,Wt))),128))]),u.value.length?L("",!0):(l(),i("tfoot",oe,[t("tr",null,[t("td",se,[t("div",ae,a(e.$t(n(Ut)(n(R)))),1)])])]))]),v.value>f?(l(),gt(Y,{key:0,modelValue:h.value,"onUpdate:modelValue":s[6]||(s[6]=o=>h.value=o),total:v.value,limit:f},null,8,["modelValue","total"])):L("",!0)],64)}}});const ge=At(le,[["__scopeId","data-v-a85a9f40"]]);export{ge as default};
